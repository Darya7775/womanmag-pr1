section.component-description(data-tabs='element')
  h3 В архиве лежат следующие файлы и папки:
  table
    tr
      th
        p PHPMailer
      td
        p Папка с&nbsp;php библиотекой для отправки данных формы на&nbsp;почту. Папка переносится в&nbsp;корень проекта. В&nbsp;неё не&nbsp;нужно вносить изменения
    tr
      th
        p send.php
      td
        p Редактируемый файл, для настройки отправки данных формы
  h3 В папке js расположена кастомная валидация лиги. В неё добавлены файлы:
  table
    tr
      th
        p send-mail.js
      td
        p Запрос на&nbsp;отправку данных с&nbsp;формы. Редактировать не&nbsp;нужно
    tr
      th
        p form-send-callbacks.js
      td
        p колбеки успешной или не&nbsp;успешной отправки данных формы
  h2.subtitle Причины сбоя отправки писем
  ol
    li
      p Проблемы на&nbsp;хостинге (возможно перезапускали сервер, возможно меняли конфигурации)
    li
      p Спам (хостинг заблокировал возможность отправки писем посчитав что вы&nbsp;спамите)
    li
      p Частые рассылки писем и&nbsp;уведомлений (сайт отправляет очень много уведомлений, очень часто для отправки используется стандартный системный транспорт и&nbsp;php функция mail, для отправки писаем используется почтовый сервер вашего хостинг провайдера, это не&nbsp;требует дополнительных настроек, но&nbsp;обычно почтовые хостинги провайдера не&nbsp;любят нагрузок как следствие письма могут попадать в&nbsp;спам, не&nbsp;отправляться)
    li
      p Конфликты на&nbsp;сайте (из-за установленных плагинов)
  h2.subtitle Варианты решений
  ol
    li
      p Деактивировать по&nbsp;очереди плагины если это WordPress
    li
      p Обратиться в&nbsp;службу поддержки хостинга
    li
      p Создать на&nbsp;хостинге корпоративную почту и&nbsp;указать её&nbsp;в&nbsp;настройках сайта
    li
      p Настроить отправку писем через SMTP-сервер с&nbsp;авторизацией
  p Мы&nbsp;будем использовать 4&nbsp;вариант, он&nbsp;является самым надёжным. Важно понимать, что тот адрес, на&nbsp;который должны приходить письма не&nbsp;имеет никакого значения, он&nbsp;может быть любым. Все настройки осуществляются для почтового сервера с&nbsp;которого будет отправляться письмо.
  p В&nbsp;зависимости от&nbsp;того с&nbsp;какого почтового сервера мы&nbsp;хотим отправлять письма, мы&nbsp;должны создать нужные нам настройки.
  h2.subtitle Пример для gmail
  ol
    li
      p SMTP сервер, зависит от&nbsp;почты отправки:
      p #[b $mail->Host = "smtp.yandex.ru";]
    li
      p Включаем SMTP авторизацию:
      p #[b $mail->SMTPAuth = true;]
    li
      p SMTP имя пользователя (почта с&nbsp;которой отправляем письмо):
      p #[b $mail->Username = "ligaatest@yandex.ru";]
    li
      p SMTP password (для яндех и&nbsp;мэйл ру&nbsp;генерируем по&nbsp;ссылке в&nbsp;инструкции, для gmail это пароль от&nbsp;почты):
      p #[b $mail->Password = "skfbddoaxyeiqglc";]
    li
      p SMTP Шифрование в&nbsp;основном это ssl, если другое не&nbsp;указанно настройках сервера:
      p #[b $mail->SMTPSecure = "ssl";]
    li
      p Порт:
      p #[b $mail->Port = 465;]
    li
      p Почта откуда отправляем:
      p #[b $mail->setFrom("ligaatest@yandex.ru");]
    li
      p Почта на&nbsp;которую должны приходить письма:
      p #[b $mail->addAddress("ligamailtest@gmail.com");]
  p От&nbsp;заказчика нам нужно узнать пункты #[b 1, 3, 4, 7, 8]. Так&nbsp;же он&nbsp;должен настроить почту по&nbsp;ссылкам ниже. Всю остальную информацию мы&nbsp;можем найти сами.

  p
    |  Ссылка на настройки yandex.ru
    |
    a(href="https://yandex.ru/support/mail/mail-clients/others.html", target="_blank", rel="nofollow noopener noreferrer") Настройка Яндекс почты
  p
    |  Ссылка на настройки mail.ru
    |
    a(href="https://help.mail.ru/mail/mailer/popsmtp", target="_blank", rel="nofollow noopener noreferrer") Настройка mail.ru
  p
    |  Ссылка на настройки gmail.com
    |
    a(href="https://support.google.com/mail/answer/7126229", target="_blank", rel="nofollow noopener noreferrer") Настройка gmail
  blockquote
    | Примите во&nbsp;внимание, что со&nbsp;включенной двухфакторной аутентификацией отправка работать не&nbsp;будет. В&nbsp;таком случае лучше создать новый почтовый ящик, важно не&nbsp;забыть дать к&nbsp;нему доступ сторонним приложениям. Прочитать как это сделать можно пройдя по&nbsp;#[a(href="https://support.google.com/accounts/answer/6010255", target="_blank", rel="nofollow noopener noreferrer") этой ссылке]
  p Для остальных почтовых серверов настройки легко гуглятся пример запроса &laquo;настройка smtp &laquo;название почтового сервера&raquo;
  p Для тестирования нужно установить программу #[a(href="https://ospanel.io/download/", target="_blank", rel="nofollow noopener noreferrer") ospanel.io]
  h2.subtitle Инструкция для разработчика
  ol
    li
      p
        |  Записать в&nbsp;переменные все используемые поля
        |
        a(href="https://skr.sh/sCPP2dujZcN?a", target="_blank", rel="nofollow noopener noreferrer") Скриншот
    li
      p
        |  Настроить сервер
        |
        a(href="https://skr.sh/sCPN8dY1bPf?a", target="_blank", rel="nofollow noopener noreferrer") Скриншот
    li
      p
        |  Добавить адреса откуда приходят письма и&nbsp;куда
        |
        a(href="https://skr.sh/sCPtrzrr3Oc?a", target="_blank", rel="nofollow noopener noreferrer") Скриншот
    li
      p
        |  Настроить отображение письма
        |
        a(href="https://skr.sh/sCPtrzrr3Oc?a", target="_blank", rel="nofollow noopener noreferrer") Скриншот
    li
      p
        |  Добавить отправку в&nbsp;колбек успешной валидации
        |
        a(href="https://skr.sh/sCPdDdYEhMI?a", target="_blank", rel="nofollow noopener noreferrer") Скриншот
    li
      p
        |  Добавить функции для реализации колбеков успешной отправки и&nbsp;ошибки отправки
        |
        a(href="https://skr.sh/sCPLMiPbTXQ?a", target="_blank", rel="nofollow noopener noreferrer") Скриншот
  p
    |  Если требуется формировать письма с&nbsp;разных форм то&nbsp;мы&nbsp;просто создаём ещё php файлы с&nbsp;другими настройками. Не&nbsp;забываем указывать эти файлы в&nbsp;атрибуте action формы
    |
    a(href="https://skr.sh/sCPLRkvPui6?a", target="_blank", rel="nofollow noopener noreferrer") Скриншот
  h2.subtitle Создание шаблона письма, добавление скрытых инпутов
  p В&nbsp;компонент был добавлен файл #[b send-template.php]
  p Периодически возникает задача, как-либо кастомизировать письма в&nbsp;зависимости от&nbsp;формы из&nbsp;которой они отправлены. Для этого мы&nbsp;используем скрытые инпуты #[b (input type=&quot;hidden&quot;)]. Для него так&nbsp;же обязательно указание атрибута #[b name=&quot;&quot;] по&nbsp;которому осуществляется поиск в&nbsp;php файле. В&nbsp;атрибуте #[b value=&quot;&quot;] мы&nbsp;указываем нужную нам информацию которую будем добавлять при формировании тела письма. Ссылки на&nbsp;изображения должны быть исключительно абсолютными.

  pre
    code.language-pug.
      // pug
      input(type="hidden", name="user-hidden-img", value="https://wallbox.ru/resize/1024x1024/wallpapers/main/201627/934e473b906f243.jpg")
      input(type="hidden", name="user-hidden-text", value="Скрытый текст с тестового сайта")

  pre
    code.language-php.
      // php
      $userHiddenImg = $_POST['user-hidden-img'];
      $userHiddenText = $_POST['user-hidden-text'];
  p Стили в отправляемом писме можно только инлайнить.

  pre
    code.language-php.
      // Шаблон письма
      $mailTemplate = "
        &lt;div style='background-color: darkgray;'>
          &lt;img src='$userHiddenImg' style='width: 200px; height: 200px;  object-fit: cover;'>
          &lt;p>$userHiddenText.&lt;/p>
          &lt;p style='color: red; font-family: arial, helvetica, sans-serif; font-size: 30px; line-height: 120%;'>Имя: $userName.&lt;/p>
          &lt;p>Телефон: $userPhone.&lt;/p>
          &lt;p>Почта: $userEmail.&lt;/p>
        &lt;/div>
      ";
